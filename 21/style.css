/* -------------------- 基础设定与色板 -------------------- */
:root{
  --glass: 24px;
  --blur-strong: 20px;
  --radius-xl: 18px;
  --radius-2xl: 24px;
  --shadow-soft: 0 10px 30px rgba(0,0,0,.25);
  --shadow-lift: 0 20px 50px rgba(0,0,0,.35);
  --card-alpha: .24; /* 前景透明度控制在 15–35% 区间 */
  --line-alpha: .35;
  --drawer-w: min(420px, 86vw);
  --z-bg: 0; --z-fx: 1; --z-card: 2; --z-drawer: 3; --z-top: 4;
}

html{ font-size: clamp(14px, 1.1vw + .35rem, 19px); background:#000;}
body{
  margin:0; color:var(--cloud-white); font-family: "Sarasa Gothic SC", "Noto Sans SC", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC", "Microsoft YaHei", sans-serif;
  line-height:1.65; letter-spacing:.2px; background:var(--night-blue);
  overflow-x:hidden;
}

/* -------------------- 背景与全局动态层 -------------------- */
.bg{ position:fixed; inset:0; z-index:var(--z-bg); background: center/cover no-repeat var(--night-blue); }
.bg::before{ /* 背景图与轻视差容器 */
  content:""; position:absolute; inset:-2%;
  background-image: var(--bg-url);
  background-size: cover; background-position:center; filter:contrast(1.02) saturate(1.04);
  will-change: transform; transform: translate3d(0,0,0) scale(1.02);
  transition: transform .2s linear;
}
.bg::after{ /* 暮色径向渐层 overlay <10% */
  content:""; position:absolute; inset:0;
  background: radial-gradient(120% 100% at 50% 0%, rgba(246,216,168,.08), transparent 60%),
              linear-gradient(to bottom, rgba(246,216,168,.06), rgba(13,39,69,.10));
  mix-blend-mode: screen; pointer-events:none;
}

/* 胶片颗粒与暗角 */
.film-grain{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; }
.film-grain::before{
  content:""; position:absolute; inset:-10%; opacity:.05; filter:contrast(150%);
  background-image: repeating-radial-gradient(circle at 0 0, rgba(255,255,255,.06) 0 1px, transparent 1px 2px);
  animation: grainShift 9s linear infinite;
}
.vignette{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; }
.vignette::after{
  content:""; position:absolute; inset:0; background: radial-gradient(120% 110% at 50% 50%, transparent 65%, rgba(0,0,0,.22));
}
@keyframes grainShift{ to{ transform:translate3d(2%, -2%, 0);} }

/* 云气漂移：极低不透明度噪声块水平缓动 */
.cloud-drift{ position:fixed; inset:-10%  -10% -10% -10%; z-index:var(--z-fx); opacity:.10; pointer-events:none; filter: blur(6px) contrast(105%);
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="512" height="256"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="0"><stop offset="0" stop-color="white" stop-opacity="0.10"/><stop offset="1" stop-color="white" stop-opacity="0.0"/></linearGradient></defs><rect width="512" height="256" fill="url(%23g)"/></svg>') repeat-x top center/1200px 60%;
  animation: cloudSlide 60s linear infinite;
  mix-blend-mode: screen;
}
@keyframes cloudSlide{ to{ background-position:-1200px 0; } }

/* 光漂粒子：Canvas 覆盖层在下方脚本绘制 */
#particles{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; opacity:.12; }

/* -------------------- 页面容器 -------------------- */
.page{ position:relative; z-index:var(--z-card); min-height:100svh; display:flex; flex-direction:column; gap:1.2rem; padding:6.5rem clamp(1rem, 5vw, 3rem); }
.safe-top{ height:min(10svh, 120px);} /* 避免压住背景高光区 */

.section{ backdrop-filter: blur(var(--blur-strong)); background: rgba(20,28,36, var(--card-alpha)); border-radius: var(--radius-2xl); box-shadow: var(--shadow-soft); position:relative; overflow:hidden; }

/* 云缘描边与霜纹高光 */
.glow-edge::before{ content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background: conic-gradient(from 0deg, rgba(169,190,214,.22), rgba(246,216,168,.18), rgba(169,190,214,.22));
  mix-blend-mode: screen; filter: blur(12px); opacity:.6; mask: linear-gradient(#000 0 0) subtract, radial-gradient(80% 80% at 50% 50%, transparent 60%, #000 61%);
  animation: edgeFlow 2.8s linear infinite;
}
.glow-edge::after{ content:""; position:absolute; inset:1px; border-radius:inherit; pointer-events:none; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06); }
@keyframes edgeFlow{ to{ transform: rotate(360deg);} }

/* 漂浮画框（场景渲染） */
.frame-cloud{ padding:1.2rem; }
.frame-cloud .frame{ position:relative; border-radius: var(--radius-2xl); overflow:hidden; background:rgba(255,255,255,.02); min-height: 36svh; display:grid; place-items:center; }
.frame-cloud .frame::before{ /* 底部极细高光线 */
  content:""; position:absolute; left:0; right:0; bottom:0; height:2px; opacity:.6;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.55), transparent);
  animation: shine 2.5s linear infinite;
}
@keyframes shine{ 0%{ transform: translateX(-40%);} 100%{ transform: translateX(40%);} }

/* 云纹角标四枚 */
.corner{ position:absolute; width:80px; height:80px; opacity:.25; filter: blur(0.2px); }
.c1{ top:10px; left:10px;} .c2{ top:10px; right:10px;} .c3{ bottom:10px; left:10px;} .c4{ bottom:10px; right:10px;}
.corner::before{ content:""; position:absolute; inset:0; border-radius:22px; border:1px solid rgba(255,255,255,.25); box-shadow: 0 0 40px rgba(246,216,168,.25) inset; animation: breathe 5s ease-in-out infinite; }
@keyframes breathe{ 0%,100%{ transform: scale(1);} 50%{ transform: scale(1.04);} }

/* 旁白 */
.narration{ padding:1rem 1.2rem; background: rgba(169,190,214,.20); }
.narration .wind-line{ position:absolute; left:8%; right:8%; top:-6px; height:2px; background:linear-gradient(90deg, transparent, rgba(246,216,168,.75), transparent); opacity:.7; transform-origin:center; animation: sway 8s ease-in-out infinite; filter: blur(.2px); }
@keyframes sway{ 0%,100%{ transform: translateY(0)} 50%{ transform: translateY(2px)} }
.narration p{ margin:.2rem 0; opacity:0; animation: lineIn .6s ease forwards; }
.narration p:nth-child(1){ animation-delay:.1s } .narration p:nth-child(2){ animation-delay:.7s } .narration p:nth-child(3){ animation-delay:1.3s }
@keyframes lineIn{ from{ transform: translateY(6px); opacity:0 } to{ transform:none; opacity:1 } }

/* 动态事件：胶片卡叠放 */
.events{ padding:1rem; display:grid; gap:.8rem; }
.film-stack{ display:grid; gap:.6rem; }
.film-card{ position:relative; padding: .9rem 1rem; border-radius: 16px; background: rgba(27,31,36,.28); box-shadow: var(--shadow-soft);}
.film-card::before{ content:""; position:absolute; inset:0; border-radius:inherit; background: radial-gradient(120% 120% at 50% 50%, rgba(246,216,168,.14), transparent 55%); filter: blur(12px); opacity:.4; mix-blend-mode: screen; }
.film-card{ animation: ink 700ms ease both; }
.film-card:nth-child(2){ transform: translateY(-2px) translateX(6px) rotate(.4deg);}
.film-card:nth-child(3){ transform: translateY(-4px) translateX(12px) rotate(-.6deg);}
@keyframes ink{ from{ clip-path: circle(0% at 50% 50%); } to{ clip-path: circle(150% at 50% 50%);} }

/* 行动选项：胶囊组 + 背后流风丝带 */
.actions{ position:relative; padding:1rem; }
.wind-ribbon{ position:absolute; inset:auto 0 0 0; height:38%; pointer-events:none; opacity:.08; background:
    repeating-linear-gradient( 90deg, rgba(246,216,168,.55) 0 1px, transparent 1px 8px),
    linear-gradient(90deg, rgba(255,255,255,.18), rgba(169,190,214,.10));
  mix-blend-mode: screen; filter: blur(1px); animation: ribbon 30s linear infinite; }
@keyframes ribbon{ to{ background-position: 1200px 0, 0 0; } }
.action-grid{ position:relative; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:.8rem; }
@media (max-width: 767px){ .action-grid{ grid-template-columns: 1fr; } }
.pill{ display:flex; align-items:center; gap:.6rem; padding:.8rem 1rem; border-radius:999px; background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10); box-shadow: 0 1px 0 rgba(255,255,255,.06) inset; backdrop-filter: blur(14px);
  transform: translateZ(0); animation: microBreath 3s ease-in-out infinite; }
.pill .tag{ font-size:.9em; opacity:.85; color:var(--warm-gold); }
@keyframes microBreath{ 0%,100%{ transform:scale(1)} 50%{ transform:scale(1.01)} }

/* 状态信息：微卡片 + 环形表盘 */
.status-info{ padding:1rem; }
.status-grid{ display:grid; gap:.8rem; grid-template-columns: repeat(3, minmax(0,1fr)); }
@media (max-width: 1199px){ .status-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width: 767px){ .status-grid{ grid-template-columns: 1fr; } }
.chip{ display:flex; align-items:center; gap:.8rem; padding:.8rem 1rem; border-radius: var(--radius-xl); background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); position:relative; }
.chip::after{ /* 露珠高光点 */ content:""; position:absolute; top:8px; right:14px; width:6px; height:6px; border-radius:50%; background: rgba(255,255,255,.6); box-shadow: 0 0 8px rgba(255,255,255,.5); animation: dew 4s ease-in-out infinite; }
@keyframes dew{ 0%,100%{ opacity:.35 } 50%{ opacity:.85 } }

.gauge{ --p: 0; width: 36px; height: 36px; border-radius:50%; background:
    conic-gradient(from -90deg, var(--warm-gold) calc(var(--p)*1%), rgba(255,255,255,.12) 0);
  display:grid; place-items:center; box-shadow: inset 0 0 0 3px rgba(169,190,214,.35); }
.gauge span{ font-size:.75em; color:#fff; }

/* -------------------- 侧边状态栏 Drawer -------------------- */
.drawer-handle-cloud{ position: fixed; top: 40%; right: 10px; z-index: var(--z-top); border:none; cursor:pointer;
  width:40px; height:80px; border-radius: 18px 0 0 18px; background: rgba(255,255,255,.12); backdrop-filter: blur(10px);
  box-shadow: var(--shadow-soft); color:#fff; display:grid; place-items:center; transition: transform .2s ease, opacity .2s;
}
.drawer-handle-cloud:hover{ opacity:.9; transform: translateX(-2px); }

.status-drawer{ position: fixed; top:0; right:0; height:100svh; width: var(--drawer-w); z-index: var(--z-drawer);
  background: rgba(13,19,27,.58); backdrop-filter: blur(18px); box-shadow: var(--shadow-lift);
  transform: translateX(100%); transition: transform .38s cubic-bezier(.2,.7,.2,1);
  display:flex; flex-direction:column; border-left:1px solid rgba(255,255,255,.08);
}
.status-drawer.open{ transform: translateX(0); }
.drawer-top{ padding:1rem; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,.08); }
.drawer-close{ border:none; background: rgba(255,255,255,.10); color:#fff; padding:.5rem .7rem; border-radius:12px; cursor:pointer; }
.drawer-scroll{ flex:1; overflow:auto; padding:1rem; }

/* 滚动条美化 */
.drawer-scroll::-webkit-scrollbar{ width:8px; }
.drawer-scroll::-webkit-scrollbar-track{ background: rgba(255,255,255,.06); border-radius: 8px; }
.drawer-scroll::-webkit-scrollbar-thumb{ background: rgba(169,190,214,.55); border-radius: 8px; }
.drawer-scroll::-webkit-scrollbar-thumb:hover{ background: rgba(169,190,214,.85); }

.backdrop{ position:fixed; inset:0; z-index: calc(var(--z-drawer) - 1); background: rgba(0,0,0,.25); opacity:0; pointer-events:none; transition: opacity .25s ease; }
.backdrop.show{ opacity:1; pointer-events:auto; }

/* -------------------- 文本与微样式 -------------------- */
h2{ font-size:1.2rem; font-weight:600; margin:0 0 .6rem; color: #E9EEF5; }
.muted{ color: rgba(255,255,255,.8) }
.thin{ opacity:.85 }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:.9em; color:#CFE2FF }