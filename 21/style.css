/* 目标：大幅降低合成与重绘成本，动画尽量在合成层运行，所有滤镜/模糊减量，提供低功耗模式 */
:root{
  --night-blue:#0D2745; --cloud-white:#F2F0EA; --warm-gold:#F6D8A8; --mist-blue:#A9BED6;
  --alpha-card:.20; --alpha-line:.25; --radius:16px; --blur:10px; /* 降低 blur */
  --shadow: 0 6px 18px rgba(0,0,0,.22); /* 降低阴影半径 */
  --drawer-w: min(380px, 86vw);
  --z-bg:0; --z-fx:1; --z-card:2; --z-drawer:3; --z-top:4;
}
html{ font-size: clamp(14px, 1vw + .35rem, 18px); background:#000; }
body{ margin:0; color:var(--cloud-white); font-family: "Noto Sans SC","Sarasa Gothic SC",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Microsoft YaHei",sans-serif; line-height:1.65; background:var(--night-blue); overflow-x:hidden; }

/* 背景与轻量动态 */
.bg{ position:fixed; inset:0; z-index:var(--z-bg); background: center/cover no-repeat var(--bg-url); transform:translateZ(0); }
.bg-overlay{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; background:
  radial-gradient(120% 100% at 50% 0%, rgba(246,216,168,.05), transparent 60%),
  linear-gradient(to bottom, rgba(246,216,168,.04), rgba(13,39,69,.08));
  mix-blend-mode: screen;
}
/* 用轻量伪元素模拟"云漂"，避免大纹理与大模糊 */
.cloud-drift{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; opacity:.06; }
.cloud-drift::before{ content:""; position:absolute; inset:-10% 0; background: repeating-linear-gradient(90deg, rgba(255,255,255,.35) 0 1px, transparent 1px 12px); filter: blur(1px); transform: translate3d(0,0,0); animation: cloud 40s linear infinite; }
@keyframes cloud{ to{ transform: translate3d(-120px,0,0);} }

/* 胶片颗粒改为静态低对比，去除动画 */
.grain{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; opacity:.04; background: repeating-radial-gradient(circle at 0 0, rgba(255,255,255,.6) 0 1px, transparent 1px 2px); }
/* 暗角轻量 */
.vignette{ position:fixed; inset:0; z-index:var(--z-fx); pointer-events:none; background: radial-gradient(120% 110% at 50% 50%, transparent 68%, rgba(0,0,0,.18)); }

/* 页面 */
.page{ position:relative; z-index:var(--z-card); min-height:100svh; display:flex; flex-direction:column; gap:1rem; padding:6rem clamp(1rem, 5vw, 3rem); }

/* 卡片：降低模糊强度与阴影，启用content-visibility减少离屏渲染 */
.section{ content-visibility:auto; contain-intrinsic-size: 500px 300px; backdrop-filter: blur(var(--blur)); background: rgba(15,20,28,var(--alpha-card)); border-radius: var(--radius); box-shadow: var(--shadow); overflow:hidden; will-change: transform; }

/* 场景渲染 */
.scene{ padding:1rem; }
.frame{ min-height: 34svh; border-radius: var(--radius); background: rgba(255,255,255,.02); position:relative; display:grid; place-items:start; padding:1rem 1.2rem; }
.frame::after{ content:""; position:absolute; left:0; right:0; bottom:0; height:2px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.45), transparent); opacity:.7; transform: translateZ(0); animation: shine 3s linear infinite; }
@keyframes shine{ 0%{ transform: translate3d(-30%,0,0);} 100%{ transform: translate3d(30%,0,0);} }

/* 旁白：仅淡入一次 */
.narration{ padding:1rem 1.2rem; background: rgba(169,190,214,.16); position:relative; }
.narration .wind{ position:absolute; left:8%; right:8%; top:-6px; height:2px; background:linear-gradient(90deg, transparent, rgba(246,216,168,.7), transparent); opacity:.6; animation:sway 8s ease-in-out infinite; transform:translateZ(0); }
@keyframes sway{ 0%,100%{ transform:translate3d(0,0,0)} 50%{ transform:translate3d(0,2px,0)} }
.narration p{ margin:.2rem 0; opacity:0; animation: fade .6s ease forwards; }
.narration p:nth-child(1){ animation-delay:.1s } .narration p:nth-child(2){ animation-delay:.7s }
@keyframes fade{ from{ transform: translateY(6px); opacity:0 } to{ transform:none; opacity:1 } }

/* 动态事件：去除大面积发光，保留轻投影 */
.events{ padding:1rem; display:grid; gap:.7rem; }
.film{ display:grid; gap:.6rem; }
.card{ padding:.85rem 1rem; border-radius:12px; background: rgba(27,31,36,.26); box-shadow: var(--shadow); clip-path: inset(0 round 12px); animation: reveal .5s ease both; }
.card:nth-child(2){ transform: translateY(-1px) translateX(4px);}
.card:nth-child(3){ transform: translateY(-2px) translateX(8px);}
@keyframes reveal{ from{ clip-path: inset(50% round 12px);} to{ clip-path: inset(0 round 12px);} }

/* 行动选项：减少滤镜，保留胶囊与轻呼吸 */
.actions{ position:relative; padding:1rem; }
.ribbon{ position:absolute; inset:auto 0 0 0; height:34%; opacity:.06; background: linear-gradient(90deg, rgba(255,255,255,.16), rgba(169,190,214,.08)); transform: translateZ(0); animation: ribbon 28s linear infinite; }
@keyframes ribbon{ to{ transform: translate3d(80px,0,0);} }
.grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:.75rem; }
@media (max-width: 767px){ .grid{ grid-template-columns: 1fr; } }
.pill{ display:flex; align-items:center; gap:.6rem; padding:.75rem 1rem; border-radius:999px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); backdrop-filter: blur(8px); animation: breath 4s ease-in-out infinite; }
@keyframes breath{ 0%,100%{ transform:scale(1)} 50%{ transform:scale(1.008)} }
.tag{ color:var(--warm-gold); opacity:.9; font-size:.9em }

/* 状态信息：环形表盘改为纯CSS conic，无滤镜叠加 */
.status{ padding:1rem; }
.s-grid{ display:grid; gap:.7rem; grid-template-columns: repeat(3, minmax(0,1fr)); }
@media (max-width: 1199px){ .s-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width: 767px){ .s-grid{ grid-template-columns: 1fr; } }
.chip{ display:flex; align-items:center; gap:.6rem; padding:.7rem 1rem; border-radius:14px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); }
.gauge{ --p:0; width:34px; height:34px; border-radius:50%; background: conic-gradient(from -90deg, var(--warm-gold) calc(var(--p)*1%), rgba(255,255,255,.12) 0); box-shadow: inset 0 0 0 2px rgba(169,190,214,.35); display:grid; place-items:center; }
.gauge span{ font-size:.74em }

/* 侧边状态栏：降低模糊与阴影，动画时长缩短 */
.handle{ position: fixed; top: 40%; right: 10px; z-index: var(--z-top); width:38px; height:72px; border:none; border-radius: 14px 0 0 14px; background: rgba(255,255,255,.12); backdrop-filter: blur(8px); color:#fff; box-shadow: var(--shadow); cursor:pointer; }
.drawer{ position:fixed; top:0; right:0; height:100svh; width:var(--drawer-w); z-index:var(--z-drawer); background: rgba(13,19,27,.56); backdrop-filter: blur(14px); border-left:1px solid rgba(255,255,255,.08); transform: translateX(100%); transition: transform .28s ease; display:flex; flex-direction:column; }
.drawer.open{ transform: translateX(0); }
.d-top{ padding:1rem; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,.08); }
.d-close{ border:none; background: rgba(255,255,255,.10); color:#fff; padding:.45rem .7rem; border-radius:10px; cursor:pointer; }
.d-scroll{ flex:1; overflow:auto; padding:1rem; }
.d-scroll::-webkit-scrollbar{ width:8px; }
.d-scroll::-webkit-scrollbar-track{ background: rgba(255,255,255,.06); border-radius: 8px; }
.d-scroll::-webkit-scrollbar-thumb{ background: rgba(169,190,214,.55); border-radius: 8px; }
.d-scroll::-webkit-scrollbar-thumb:hover{ background: rgba(169,190,214,.85); }
.backdrop{ position:fixed; inset:0; z-index: calc(var(--z-drawer) - 1); background: rgba(0,0,0,.22); opacity:0; pointer-events:none; transition: opacity .2s; }
.backdrop.show{ opacity:1; pointer-events:auto; }

h2{ font-size:1.15rem; font-weight:600; margin:0 0 .6rem; color:#E9EEF5; }
.muted{ color: rgba(255,255,255,.85) }

/* 优化：系统"减少动态"时关闭动画 */
@media (prefers-reduced-motion: reduce){
  *{ animation: none !important; transition: none !important; }
}

/* 低功耗模式：通过 [data-perf="low"] 降级更多效果 */
body[data-perf="low"]{
  --blur: 6px; --alpha-card:.18;
}
body[data-perf="low"] .cloud-drift{ display:none; }
body[data-perf="low"] .grain{ opacity:.03 }
body[data-perf="low"] .ribbon{ display:none; }
body[data-perf="low"] .frame::after{ display:none; }