:root{
  --bg-url:url("https://cdn.jsdelivr.net/gh/guasnq/wenyouzl_style@main/img/16.webp");
  --c-bg:#0B0F13; --c-red:#D31919; --c-red-hi:#F04A3E; --c-iron:#6A737A; --safe:clamp(24px,4vw,48px);
  --w:min(980px,92vw); --fs:clamp(14px,1.2vw + .2rem,18px); --title:clamp(22px,3.4vw + .2rem,36px); --subtitle:clamp(16px,2vw + .2rem,22px);
  --breath-dur:1.4s;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:"Source Han Serif SC","PingFang SC","Noto Serif SC",system-ui,Arial,"Microsoft YaHei",sans-serif;
  color:#D6DEE3;
  font-size:var(--fs);
  line-height:1.7;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;

  /* 兜底背景：即便 .bg 层异常，也能看到图 */
  background-color:#000;
  background-image:var(--bg-url);
  background-size:cover;
  background-position:center 20%;
  background-repeat:no-repeat;
}

/* 开关按钮 */
.side-toggle{
  position:fixed; right:10px; top:10px; z-index:60;
  background:rgba(10,16,20,.6); color:#cfd8dc; border:1px solid rgba(240,74,62,.35);
  padding:.4rem .7rem; cursor:pointer; letter-spacing:.1em; backdrop-filter:saturate(120%) blur(2px);
  transition:.25s ease; border-radius:8px;
}
.side-toggle:hover{transform:translateY(-1px); box-shadow:0 0 0 1px rgba(240,74,62,.25),0 6px 14px rgba(0,0,0,.4)}

/* 侧边状态面板（覆盖浮层） */
.side-panel{
  position:fixed; inset:0 0 0 auto; width:min(340px,86vw);
  transform:translateX(102%); transition:transform .32s cubic-bezier(.22,.61,.36,1);
  background:linear-gradient(180deg,rgba(3,6,8,.9),rgba(5,10,12,.96)); border-left:1px solid rgba(240,74,62,.2);
  z-index:80; display:flex; flex-direction:column;
}
.side-panel.open{transform:none}
.side-head{display:flex; align-items:center; gap:.6rem; padding:.8rem .9rem; border-bottom:1px dashed rgba(240,74,62,.25); position:sticky; top:0; background:inherit; z-index:1}
.side-head .dot{width:10px;height:10px;border-radius:50%;display:inline-block;background:var(--c-red);box-shadow:0 0 10px rgba(240,74,62,.6)}
.side-head h3{margin:0;font-size:1.05rem;letter-spacing:.18em}
.side-close{margin-left:auto;background:transparent;color:#c6cfd3;border:0;font-size:1.2rem;cursor:pointer;padding:.2rem .4rem}
.side-body{padding:.8rem .9rem; overflow:auto}
.side-body .kv{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:1fr auto;gap:.35rem .8rem}
.side-body .kv li{display:contents}
.side-body .kv span{color:#91a0a9}
.side-body .kv b{color:#e8edf0}
.side-body .record{margin:.9rem 0 0;color:#8aa1a9}
.side-body::-webkit-scrollbar{width:10px}
.side-body::-webkit-scrollbar-track{background:rgba(15,22,26,.5)}
.side-body::-webkit-scrollbar-thumb{background:linear-gradient(var(--c-red),#9b1717);border-radius:8px}
.side-body{scrollbar-width:thin; scrollbar-color:#9b1717 rgba(15,22,26,.5)}

/* 舞台与背景层 */
.stage{position:relative; min-height:100svh; overflow-x:hidden}
.bg{
  position:fixed; inset:0; z-index:0;
  /* 主背景层：与 body 同步，双保险 */
  background-image:var(--bg-url);
  background-size:cover;
  background-position:center 20%;
  background-repeat:no-repeat;
  transform:translateZ(0);
  will-change:transform;
}
/* 轻量全局动效：不遮背景，纯 transform/opacity */
.fx{position:fixed; inset:0; pointer-events:none; z-index:1}
.fx.breathe{
  background:radial-gradient(120% 70% at 50% 10%, rgba(255,60,60,.05), transparent 55%);
  animation:breathe var(--breath-dur) ease-in-out infinite alternate; opacity:.35;
}
.fx.fog{
  background:
    radial-gradient(120% 60% at 50% -10%, rgba(10,25,30,.18), transparent 55%),
    linear-gradient(180deg, rgba(6,14,18,.14), rgba(6,14,18,0) 45%, rgba(6,14,18,.16));
  animation:fogDrift 60s linear infinite;
  opacity:.9; /* 很淡，不会糊图 */
  will-change:transform;
}
.fx.glare{
  position:fixed; left:-50%; right:-50%; height:10px; bottom:2vh; top:auto; z-index:1;
  background:linear-gradient(to right, transparent 0%, rgba(255,255,255,.12) 45%, rgba(255,255,255,0) 70%);
  animation:glareSlide 40s linear infinite;
  will-change:transform;
}

/* 容器与单列网格 */
.stack{
  position:relative; z-index:2;
  width:var(--w); margin:0 auto; padding:var(--safe) var(--safe) calc(var(--safe) + 24px);
  display:flex; flex-direction:column; gap:clamp(12px,1.8vw,18px);
  color:#D6DEE3;
}

/* 卡片样式：中式窗棂感边框，流光改为低频渐变（更省） */
.card{
  position:relative; padding:clamp(14px,2.2vw,22px);
  background:linear-gradient(180deg, rgba(8,12,16,.64), rgba(8,12,16,.58));
  border:1px solid rgba(117,129,138,.35);
  box-shadow:inset 0 0 0 1px rgba(240,74,62,.12), 0 8px 24px rgba(0,0,0,.45);
  backdrop-filter: blur(2px) saturate(115%);
}
.card::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:linear-gradient(90deg, transparent, rgba(240,74,62,.18), transparent);
  background-size:200% 1px; background-repeat:repeat-x; background-position:0 0;
  animation:borderRun 24s linear infinite;
}
.card::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  mask: radial-gradient(120% 120% at 50% -10%, transparent 34%, #000 42%),
        radial-gradient(120% 120% at 50% 110%, transparent 34%, #000 42%);
  background: radial-gradient(60% 30% at 0% 0%, rgba(255,255,255,.06), transparent 60%),
              radial-gradient(60% 30% at 100% 100%, rgba(255,255,255,.06), transparent 60%);
  opacity:.35;
}

/* 文案排版 */
.scene h1{font-size:var(--title); margin:.2rem 0 .5rem; letter-spacing:.05em}
.scene p{font-size:var(--subtitle); color:#D7E0E5}

/* 旁白打字机条（低频抖动） */
.narrator .ticker{background:rgba(0,0,0,.7); border:1px dashed rgba(255,255,255,.15); padding:.8rem 1rem}
@keyframes jitter{0%,100%{letter-spacing:.02em}50%{letter-spacing:.035em}}
.narrator .ticker{animation:jitter 3.2s ease-in-out infinite}

/* 动态事件 */
.events ul{list-style:none; padding:0; margin:0; display:grid; gap:.5rem}
.events li{display:flex; align-items:center; gap:.6rem}
.lantern{
  width:.9rem; height:.9rem; border-radius:50%;
  background:radial-gradient(circle at 40% 40%, var(--c-red-hi), var(--c-red) 60%, #811313 100%);
  box-shadow:0 0 12px rgba(240,74,62,.6);
}

/* 行动选项：红封条呼吸（低频） */
.actions .seal{
  border:1px solid rgba(240,74,62,.35); color:#f2dada; padding:.6rem .8rem; margin:.35rem 0;
  background:linear-gradient(180deg, rgba(81,12,12,.25), rgba(81,12,12,.05));
  animation:paperBreath 4s ease-in-out infinite;
}
@keyframes paperBreath{0%,100%{transform:scale(1)}50%{transform:scale(.988)}}
.actions .cmd{margin-top:.5rem; color:#cbd5db}
.actions .line{display:inline-block; min-width:11ch; border-bottom:1px solid rgba(255,255,255,.4)}

/* 状态信息：纵向温度计（更省） */
.stats .meters{display:flex; gap:12px; align-items:flex-end; margin-bottom:.6rem}
.meter{
  --val:50;
  width:26px; height:120px; border:1px solid rgba(255,255,255,.22);
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
  position:relative; overflow:hidden;
}
.meter::before{content:""; position:absolute; inset:6px 8px 6px 8px; background:repeating-linear-gradient(to top, rgba(255,255,255,.07) 0 1px, transparent 1px 9px)}
.meter::after{
  content:""; position:absolute; left:8px; right:8px; bottom:6px; height:calc(var(--val) * 1%);
  background:linear-gradient(180deg, var(--c-red-hi), var(--c-red)); box-shadow:0 0 10px rgba(240,74,62,.4) inset;
  transform-origin:bottom; animation:shake 3s ease-in-out infinite;
}
@keyframes shake{0%,100%{transform:scaleY(1)}50%{transform:scaleY(1.008)}}
.stats .nums{color:#cbd5db; font-size:.95em}

/* 动画与自适应 */
@keyframes breathe{from{opacity:.25}to{opacity:.45}}
@keyframes fogDrift{0%{transform:translate3d(0,-2%,0)}100%{transform:translate3d(0,2%,0)}}
@keyframes glareSlide{0%{transform:translateX(0)}100%{transform:translateX(50%)}}
@keyframes borderRun{0%{background-position:0 0}100%{background-position:200% 0}}

/* 低性能/省电模式（由 JS 自动加 .low） */
.low .fx.breathe,.low .fx.fog,.low .fx.glare{animation:none; opacity:.12}
.low .actions .seal,.low .narrator .ticker,.low .meter::after{animation:none}
.low .card::before{animation:none}

/* 小屏 */
@media (max-width:480px){
  .stack{padding:calc(var(--safe) * .75)}
  .meter{height:110px;width:22px}
}
